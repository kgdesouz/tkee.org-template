--- 
title: Leaflet

author: "Ken De Souza"

tags:
  - Projects

---
<script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
<link rel="stylesheet" href="../stylesheets/leaflet.css" />

<div id="map" style="height:500px"></div>
<script src="../js/data.js" type="text/javascript"></script>
<script src="../js/data_0.js" type="text/javascript"></script>
<script src="../js/data_1.js" type="text/javascript"></script>
<script src="../js/data_2.js" type="text/javascript"></script>
<script src="../js/data_3.js" type="text/javascript"></script>
<script src="../js/data_4.js" type="text/javascript"></script>
<script src="../jjs/data_5.js" type="text/javascript"></script>
<script src="../js/data_6.js" type="text/javascript"></script>
<script src="../js/data_7.js" type="text/javascript"></script>
<script src="../js/data_8.js" type="text/javascript"></script>
<script src="../js/data_9.js" type="text/javascript"></script>
<script src="../js/data_NA.js" type="text/javascript"></script>

<script src="../js/leaflet.js"></script>
<!--<script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>-->
<!--<script src="http://dev.tkee.org/leaflet-dvf-master/dist/leaflet-dvf.js"></script>-->

<script src="../js/leaflet-custom.js" type="text/javascript"></script>
        

A First Level Header
====================

A starters guide
---------------------


Got it running in Nanoc. Used http://wiki.openstreetmap.org/wiki/OpenLayers_Simple_Example, ripped the scripts into their own JS files and drove it from there.



Got a POI to show up

trying http://wiki.openstreetmap.org/wiki/Openlayers_POI_layer_example
     - massage the data (doing it with one point first)

data massage

here's the updated code so you don't have to parse the problem data out.. it should just put a placeholder in there.

Bam, another problem.. bam, another problem. I am usually pretty lazy when it comes to these tasks. However, in the case I didn't put a simple if clause in, and for whatever reason, I spent a good hour parsing the data manually. Silly me.

here's a few lines of ruby to get the geo code. I did it through the bing interface since the google one has a limit. Bing apparently has a 10k limit, more than enough for me. Here's some info
API key: required
Key signup: http://www.bingmapsportal.com

% of teachers
% of schools (by district)
% of highest ranked school boards (based on average score of schools)
distribution of data against ranking


Stupid using windows to get ruby to work. boo. Decided to make sure I can get Ruby to work properly on my Mac

http://jfire.io/blog/2012/03/02/xcode-4-dot-3-homebrew-and-ruby/

- easy peasy. had the cane the encoding (using vim, just load the file and use :write ++enc=utf-8 … to determine, just do a "file -I <filename>" at a term prompt

17 May, 2013
changed gears: going to redo this in https://github.com/humangeo/leaflet-dvf (leaflet JS). Found out that dynamic data is hard to do in OpenLayers. Seems much easier to do with leaflet

used : http://www.cparker15.com/code/utilities/csv-to-json/ (https://github.com/cparker15/csv-to-json) to convert csv to json


converting to geoJSON (just easier)
https://github.com/andrewjdyck/infantProjects/tree/master/csvToGeoJSON

Apparently what they have in their tutorials don't actually match what they have in their distributions:
.. these should behave the same, but they don't. ugh. about 1-2 hours wasted with that one.
<script src="http://leafletjs.com/dist/leaflet.js"></script>
<!--<script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>-->

TODO: need to reverse lat/long and update json to match the format… a few changes and tweaks to the python script


19 May, 2013  - after trying this weekend to play with the data, now I'm able to display the data. The JSON format needed some pruning and things like keeping the encoding type correct (and consistent). I had with UTF-8, but I messed it up a few times after I put in Excel over a period of time.

To keep the dataset smaller, maybe break it down by public/catholic high school/elementary


20 May, 2013 
Started with trying to figure out the layers I wanted to use. Not sure.. I think I want to break it out by catholic vs. public. Then maybe by rating? think about it.

Got the script running pretty easily, which is sweet...

21 May, 2013 

used: http://www.colorhexa.com/ for colour gradients
http://colorbrewer2.org/
 
some problems that were noticed.
- getting the geographic data, sometimes that would not get retrieved. Also, 



Ranking DataNo Ranking DataGeographic DataGreat! Thing work as expectedSometimes there isn't any data.No Geographic DataThis is bad. We should be able to get all the 
geographic data, however, we are unable to do so.Leaves a hole in the data set.
Things that need to be fixed:
- better use of the point data marker. I think there are some layers here that could be collapsed into a cluster, rather than just laying the point data together
- data loss due to massaging of the data. I know there are some schools in my area that fall into the "No geo data/Ranking Data"; I'd like to manually fix that, but at a later time.
- a way to make the map load faster. Right now, theres about 3 MB of data being loaded. I think I can get it to load more dynamically than that.
- there's data that sitting at coordinates 0,0 (in the middle of the Atlantic). That's because I have no geographic data for that. I think that can be fixed easily, but I wanted to at least capture the data.






